---
title: 编译原理概述
tags:
  - 计算机基础
  - 编译原理
  - 编译程序
  - 解析程序
categories: 编译原理
abbrlink: a070bf7
---

## 什么是编译程序？

从功能上看，一个编译程序就是一个语言翻译程序。把一种语言（即源程序）书写的程序翻译成另一种语言（目标程序）的等价程序。

![image-20211007180707329](/images/image-20211007180707329.png)

但是除了编译程序外，还需要一些其他的程序才能生成可在计算机上执行的目标程序。

![image-20211007180836858](/images/image-20211007180836858.png)

## 编译过程和编译程序的结构

编译程序完成从源程序到目标程序的翻译工作，划分成阶段进行，每个阶段将源程序的一种表示形式转换成另一种表示形式。典型的划分方法是将编译过程划分为词法分析、语法分析、语义分析、中间代码生成、代码优化和目标代码生成6个阶段。

![](/images/image-20211007181312682.png)

### 编译程序过程概述

#### 词法分析(lexical analysis)

词法分析的任务是从左到右一个字符一个字符地读入源程序，对构成源程序的字符流进行扫描和分解，从而识别出一个个单词（有时候也称为单词符号或符号）,确定单词类型，将识别出的单词转换成统一的机内表示---词法单元（token）形式。

```
token: <种别码，属性值>
```

| 单词类型 | 种别                                                    | 种别码             |
| -------- | ------------------------------------------------------- | ------------------ |
| 关键词   | Program、if、else...                                    | 一词一码           |
| 标识符   | 变量名、数组名、记录名、过程名...                       | 多词一码           |
| 常量     | 整型、浮点型、字符型、布尔型...                         | 一型一码           |
| 运算符   | 算术（+ - * / ++）、关系（>,<,==,!=,>=,<=）逻辑（&\|~） | 一词一码或一型一码 |
| 界限符   | ;()={}...                                               | 一词一码           |

例如：

```java
position = initial + rate * 60
```

这个赋值语句中的字符可以组合成如下字素（lexeme），并映射成为如下词法单元。这些词法单元将被传递给语法分析阶段。

1. positon是一个词素，被映射成词法单元<id,1>，其中id是表示标识符(identifier)的抽象符号，而1指向符号表中position对应的条目。一个标识符对应的符号表条目存放该标识符有关的信息，比如他的名字和类型。
2. 赋值符号=是一个词素，被映射成词法单元<=>。因为这个词法单元不需要属性值，所以我们省略第二个分量，也可以使用assign这样的抽象符号作为词法单元的名字。
3. initial是一个词素，被映射成<id,2>，其中2指向initial对应的符号表条目。
4. +是一个词素，被映射成词法单元<+>。
5. rate是一个词素，被映射成词法单元<id,3>，其中3指向rate对应的符号表条目。
6. *是一个词素，被映射成词法单元<\*>。
7. 60是一个词素，被映射成词法单元<60>(技术上讲是建立一个<number,4>的词法单元)。

所以上面的复制语句被表示成如下的词法单元序列：

```
<id,1> <=> <id,2> <+> <id,3> <*> <number,4>
```

![image-20211009185656328](/Users/yuki/Library/Application Support/typora-user-images/image-20211009185656328.png)



#### 语法分析

语法分析的任务是在词法分析的基础上将单词序列分解成各类语法短语（也称为语法单位），可以表示成语法树。

如单词序列：

```pascal
id1 := id2 + id3 * 10
```

![image-20211007182058600](/images/image-20211007182058600.png)

词法分析所依据的是语言的语法规则，即描述程序结构的规则。程序的结构通常是由递归规则表示的，例如，可以用下面的规则来表示表达式：

1. 任何标识符是表达式。
2. 任何常数（整常数、实常数）是表达式。
3. 若表达式1和2都是表达式，那么：`表达式1+表达式2` 、`表达式1*表达式2`都是表达式。

#### 语义分析

语义分析是审查源程序有无语义错误，为代码生成阶段收集类型信息。语义分析的一个工作是进行类型审查，审查每个算符是否具有规范允许的运算对象，当不符合语言规范时，编译程序应报告错误。

#### 中间代码生成

进行了语法分析和语义分析之后，有的编译程序将源程序变成一种内部表示形式，即中间语言或中间代码。中间代码是一种结构简单、含意明确的记号系统。

#### 代码优化

该阶段的任务是将中间代码进行变换或进行改造，目的是使生成的目标代码更为高效，即省时间和省空间。

#### 目标代码生成

把中间代码变换成特定机器上的绝对指令代码或可重定位的指令代码或编译指令代码。

### 编译程序的结构

6个阶段的任务对应6个模块完成：词法分析程序、语法分析程序、语义分析程序、中间代码生成程序、代码优化程序和目标代码生成程序。另外完整的编译程序还必需包括表格管理程序和出错处理程序。

![](/images/image-20211007212938427.png)

### 编译阶段的组合

编译的过程可分为前端（analysis：分析部分）和后端（synthesis：综合部分），前端的工作主要依赖于源语言而与目标机无关。前端通常包括词法分析、语法分析、语义分析和中间代码生成，某些优化工作也可放在前端做，还包括与前端相关的出错处理工作和符号表管理工作。后端指的是那些依赖于目标机而一般不依赖于源程序，只与中间代码有关的那些阶段工作，即目标代码生成，以及相关出错处理和符号表操作。

## 解释程序和一些软件工具

### 解释程序

**解释型语言**（英语：Interpreted language）是一种编程语言类型。这种类型的编程语言，会将代码一句一句直接运行，不需要像编译语言（Compiled language）一样，经过编译器]先行编译为机器代码，之后再运行。JavaScript也是解释语言。

![image-20211007223843742](/images/image-20211007223843742.png)

编译程序与解释程序的不同工作模式：

![image-20211007223929684](/images/image-20211007223929684.png)

解析程序的输入包括源程序和源程序的初始数据（输入数据），它不生成目标代码，直接输出结果。

编译程序和解释程序的存储组织也有很大不同。经由编译程序处理时，在源程序被编译的阶段，存储区要为源程序（中间形式）和目标代码开辟空间，要存放编译用的各种表格，如符号表。在目标代码运行阶段，存储区主要是目标代码和数据，编译所用的任何信息都不需要了。

解释程序一般是把源程序一个语句一个语句地进行语法分析，转换为一种内部表示形式，存放在源程序区。解释程序允许在执行用户程序时修改用户程序，这要求在解释程序工作的整个过程中，源程序、符号表等内容始终存放在存储区中，并且存放格式要设计得易于使用和修改。

![image-20211007224751572](/images/image-20211007224751572.png)

程序的解释是非常慢的，在有些语言（如Java）的处理环境既有编译程序，也有解释程序。

![image-20211007225544832](/images/image-20211007225544832.png)

### 处理源程序的软件工具

为了提高软件开发的效率和质量，需要有一套软件开发过程所遵循的规范和标准，应使用先进的软件开发方法，并有相迎的软件工具的支持。

#### 软件的结构化编辑器

结构化编辑器不仅具有通常的正文编辑器的正文编辑和修改功能，而且还能像编译程序那样对源程序正文进行分析，能够执行一些对正确编制程序有帮助的附加任务。

#### 语言程序的调试工具

调试工具的作用是让编程人员了解程序的执行结果和编程人员的意图是否一致，程序的执行石沟实现预期的算法和功能。

#### 格式化工具

程序格式化工具分析源程序并以使程序结构变得清晰可读的形式打印出来。

#### 语言程序测试工具

语言程序的测试工具有两种：静态分析器和动态测试器。

**静态分析器**：是在不运行程序的情况下对源程序进行静态分析，以发现程序中潜在的错误或异常。它对源程序进行语法分析并制定相应表格，检查变量定值与引用的关系，如某变量未被赋值就被引用，或定值后未被引用，或多余的源代码等一些编译程序的语法分析发现不了的错误。

**动态测试工具**：也是首先对源程序进行分析，在分析基础上将用于记录和显示程序执行轨迹的语句或函数插入到源程序的适当位置，并用测试用例记录和显示程序运行时的实际路径，将运行结果与预期的结果进行比较分析，帮助编程人员查找问题。

#### 程序理解工具

程序理解工具对程序进行分析，确定模块间的调用关系，记录程序数据静态属性和结构属性，并画出控制流程图，帮助用户理解程序。

#### 高级语言之间的转换工具

转换工具是把一种高级语言转换成另一种高级语言，乃至汇编 语言转换成高级语言的工具。转换工作要对被转换的语言进行词法和语法分析，只不过生成的目标语言是另一种高级语言而已。
